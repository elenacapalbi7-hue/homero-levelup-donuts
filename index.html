<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Homero Multiverse RPG</title>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: 'Courier New', monospace; overflow: hidden; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; pointer-events: none; z-index: 100; }
        .hud { background: rgba(0,0,0,0.9); padding: 10px; border: 2px solid #ff69b4; border-radius: 10px; display: inline-block; }
        #game-info { color: #00ffea; font-weight: bold; }
    </style>
</head>
<body>

<div id="ui">
    <div class="hud">
        <div id="game-info">NIVEL 1: POK√âMON (Exploraci√≥n)</div>
        Objetivo: <span id="mision">Busca la dona en la hierba</span> | <span id="progreso">0/10</span>
    </div>
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let nivelActual = 0;
let puntos = 0;
let jugador = { x: canvas.width/2, y: canvas.height/2, w: 40, h: 60 };
let objetivo = { x: 100, y: 100 };
let obstaculos = [];

// Lista de juegos con sus mec√°nicas
const juegos = [
    { n: "POK√âMON RED", m: "EXPLORACI√ìN TIPO RPG", c: "#78C850" },
    { n: "DIABLO II", m: "ESQUIVAR PROYECTILES", c: "#300" },
    { n: "FINAL FANTASY VI", m: "COMBATE POR TURNOS (TAP)", c: "#000055" },
    { n: "EARTHBOUND", m: "RITMO Y REFLEJOS", c: "#f0f" },
    { n: "DRAGON QUEST V", m: "LABERINTO", c: "#4169E1" }
];

// Captura de toque para mover al personaje
window.addEventListener('touchmove', (e) => {
    e.preventDefault();
    let tx = e.touches[0].clientX;
    let ty = e.touches[0].clientY;
    
    // En Nivel 1 y 5 (RPG/Laberinto) el personaje sigue al dedo en 4 direcciones
    jugador.x += (tx - jugador.x) * 0.1;
    jugador.y += (ty - jugador.y) * 0.1;
}, { passive: false });

function resetObjetivo() {
    objetivo.x = Math.random() * (canvas.width - 50);
    objetivo.y = Math.random() * (canvas.height - 150) + 50;
}

function loop() {
    ctx.fillStyle = juegos[nivelActual].c;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // MEC√ÅNICA SEG√öN NIVEL
    if (nivelActual === 0) { // POK√âMON: Explorar
        ctx.fillStyle = "rgba(0,0,0,0.2)";
        for(let i=0; i<canvas.width; i+=40) ctx.fillRect(i, 0, 1, canvas.height); // Rejilla RPG
    } 
    
    if (nivelActual === 1) { // DIABLO: Lluvia de fuego
        if (Math.random() < 0.05) obstaculos.push({x: canvas.width, y: Math.random()*canvas.height, s: 5});
        ctx.fillStyle = "orange";
        obstaculos.forEach((o, i) => {
            o.x -= o.s;
            ctx.fillText("üî•", o.x, o.y);
            // Si te toca el fuego, pierdes puntos
            if(Math.abs(o.x - jugador.x) < 20 && Math.abs(o.y - jugador.y) < 20) {
                puntos = Math.max(0, puntos - 0.1);
                obstaculos.splice(i, 1);
            }
        });
    }

    // Dibujar Jugador (Homero)
    ctx.fillStyle = "#FFD700";
    ctx.fillRect(jugador.x, jugador.y, jugador.w, jugador.h);
    ctx.strokeRect(jugador.x, jugador.y, jugador.w, jugador.h);

    // Dibujar Dona Objetivo
    ctx.font = "40px Arial";
    ctx.fillText("üç©", objetivo.x, objetivo.y);

    // Ver colisi√≥n
    let dist = Math.hypot(jugador.x - objetivo.x, jugador.y - objetivo.y);
    if (dist < 40) {
        puntos++;
        document.getElementById('progreso').innerText = Math.floor(puntos) + "/10";
        resetObjetivo();
        if (puntos >= 10) subirNivel();
    }

    requestAnimationFrame(loop);
}

function subirNivel() {
    nivelActual++;
    puntos = 0;
    obstaculos = [];
    document.getElementById('progreso').innerText = "0/10";
    
    if (nivelActual < juegos.length) {
        let j = juegos[nivelActual];
        document.getElementById('game-info').innerText = "NIVEL " + (nivelActual+1) + ": " + j.n;
        document.getElementById('mision').innerText = j.m;
        alert("¬°ENTRANDO A " + j.n + "!\nModo: " + j.m);
    } else {
        alert("¬°Primeros 5 mundos completados!");
        nivelActual = 0;
    }
}

resetObjetivo();
loop();
</script>
</body>
</html>
