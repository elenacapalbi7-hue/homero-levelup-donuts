<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Homer Dash 25 - NIVELES 1-5</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Arial Black', sans-serif; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; background: #0a0a0a; }
        canvas { display: block; }

        /* UI */
        #hud { position: absolute; top: 40px; width: 100%; display: flex; justify-content: space-around; 
               color: #FFD700; font-size: 20px; z-index: 10; pointer-events: none; text-shadow: 2px 2px #000; }

        /* CONTROL √öNICO (DERECHA Y ELEVADO) */
        #jump-zone { 
            position: absolute; bottom: 200px; right: 30px; 
            width: 120px; height: 120px; background: rgba(255, 215, 0, 0.2); 
            border: 4px solid #FFD700; border-radius: 50%; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 40px; color: white; z-index: 100; touch-action: none;
        }

        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                   background: rgba(0,0,0,0.9); display: flex; flex-direction: column; 
                   justify-content: center; align-items: center; color: white; z-index: 200; text-align: center; }
        
        .btn-start { padding: 20px 50px; font-size: 24px; background: #FFD700; border: none; border-radius: 15px; font-weight: bold; color: #000; cursor: pointer; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="hud">
        <div>NIVEL: <span id="lvl-txt">1</span></div>
        <div>DISTANCIA: <span id="dist-txt">0</span>%</div>
    </div>

    <canvas id="gameCanvas"></canvas>
    <div id="jump-zone">‚¨ÜÔ∏è</div>

    <div id="overlay">
        <h1 id="title">HOMER DASH</h1>
        <p id="desc">Mec√°nica Geometry Dash: ¬°Solo salta!</p>
        <button class="btn-start" onclick="startLevel()">EMPEZAR</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    let level = 1, active = false, frame = 0;
    let player = { x: 100, y: 0, w: 50, h: 50, vy: 0, gravity: 0.6, jumpPower: -13, grounded: false };
    let obstacles = [], items = [], platforms = [];
    let levelLength = 5000; // Pixeles de largo del nivel
    let cameraX = 0;

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function buildLevel(num) {
        obstacles = []; platforms = []; items = [];
        cameraX = 0; player.x = 100; player.vy = 0;
        
        const spacing = 400;
        for(let i = 1; i < 15; i++) {
            let x = i * spacing;
            
            if(num === 1) { // NIVEL 1: Introducci√≥n (Solo saltos b√°sicos)
                obstacles.push({x: x, y: canvas.height - 95, w: 40, h: 50, type: 'spike'});
            } 
            else if(num === 2) { // NIVEL 2: Plataformas (Escalones de a 1)
                platforms.push({x: x, y: canvas.height - 200, w: 150, h: 20});
                obstacles.push({x: x + 60, y: canvas.height - 250, w: 30, h: 30, type: 'fire'});
            }
            else if(num === 3) { // NIVEL 3: El Techo (Obst√°culos arriba)
                obstacles.push({x: x, y: canvas.height - 95, w: 40, h: 50, type: 'spike'});
                obstacles.push({x: x + 200, y: canvas.height - 300, w: 100, h: 20, type: 'roof'});
            }
            else if(num === 4) { // NIVEL 4: Saltos Dobles (Plataformas altas)
                platforms.push({x: x, y: canvas.height - 180, w: 120, h: 20});
                platforms.push({x: x + 250, y: canvas.height - 320, w: 120, h: 20});
            }
            else if(num === 5) { // NIVEL 5: Caos (Velocidad y Gravedad leve)
                obstacles.push({x: x, y: canvas.height - 95, w: 50, h: 80, type: 'wall'});
                items.push({x: x + 200, y: canvas.height - 250});
            }
        }
    }

    function update() {
        if(!active) return;
        
        // Movimiento autom√°tico hacia adelante (Lento)
        player.x += 5; 
        cameraX = player.x - 100;

        // Gravedad y Salto
        player.vy += player.gravity;
        player.y += player.vy;

        // Suelo
        if(player.y > canvas.height - 95) {
            player.y = canvas.height - 95;
            player.vy = 0;
            player.grounded = true;
        } else {
            player.grounded = false;
        }

        // Colisi√≥n Plataformas (Escalones de a 1)
        platforms.forEach(p => {
            if(player.x + player.w > p.x && player.x < p.x + p.w &&
               player.y + player.h > p.y && player.y + player.h < p.y + 15 && player.vy > 0) {
                player.y = p.y - player.h;
                player.vy = 0;
                player.grounded = true;
            }
        });

        // Colisi√≥n Obst√°culos (Muerte)
        obstacles.forEach(ob => {
            if(player.x < ob.x + ob.w && player.x + player.w > ob.x &&
               player.y < ob.y + ob.h && player.y + player.h > ob.y) {
                die();
            }
        });

        // Progreso
        let progress = Math.min(Math.floor((player.x / levelLength) * 100), 100);
        document.getElementById('dist-txt').innerText = progress;
        if(progress >= 100) win();
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Fondo
        ctx.fillStyle = level % 2 === 0 ? "#1a001a" : "#001a1a";
        ctx.fillRect(0,0,canvas.width, canvas.height);

        ctx.save();
        ctx.translate(-cameraX, 0);

        // Dibujar Suelo
        ctx.fillStyle = "#333";
        ctx.fillRect(0, canvas.height - 45, levelLength + 1000, 45);
        ctx.strokeStyle = "#FFD700";
        ctx.strokeRect(0, canvas.height - 45, levelLength + 1000, 2);

        // Dibujar Obst√°culos
        ctx.fillStyle = "#ff4444";
        obstacles.forEach(ob => {
            if(ob.type === 'spike') {
                ctx.beginPath();
                ctx.moveTo(ob.x, ob.y + ob.h);
                ctx.lineTo(ob.x + ob.w/2, ob.y);
                ctx.lineTo(ob.x + ob.w, ob.y + ob.h);
                ctx.fill();
            } else {
                ctx.fillRect(ob.x, ob.y, ob.w, ob.h);
            }
        });

        // Dibujar Plataformas
        ctx.fillStyle = "#00FF00";
        platforms.forEach(p => ctx.fillRect(p.x, p.y, p.w, p.h));

        // Dibujar a Homero
        ctx.font = "50px Arial";
        ctx.fillText("üèÉ‚Äç‚ôÇÔ∏è", player.x, player.y + 45);

        ctx.restore();
        
        if(active) {
            update();
            requestAnimationFrame(draw);
        }
    }

    function startLevel() {
        document.getElementById('overlay').style.display = "none";
        document.getElementById('lvl-txt').innerText = level;
        buildLevel(level);
        active = true;
        draw();
    }

    function die() {
        active = false;
        document.getElementById('overlay').style.display = "flex";
        document.getElementById('title').innerText = "¬°D'OH!";
        document.getElementById('desc').innerText = "Nivel " + level + " fallido.";
    }

    function win() {
        active = false;
        level++;
        document.getElementById('overlay').style.display = "flex";
        document.getElementById('title').innerText = "¬°EXCELENTE!";
        document.getElementById('desc').innerText = "Pasaste al nivel " + level;
    }

    // CONTROL DE SALTO
    const jumpBtn = document.getElementById('jump-zone');
    const handleJump = (e) => {
        e.preventDefault();
        if(player.grounded) {
            player.vy = player.jumpPower;
            player.grounded = false;
        }
    };
    jumpBtn.addEventListener('touchstart', handleJump);
    window.addEventListener('keydown', (e) => { if(e.code === 'Space') handleJump(e); });

</script>
</body>
</html>
