<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Homer Odyssey Fix</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: sans-serif; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; background: #001a33; display: flex; flex-direction: column; }
        
        /* √Årea de juego */
        #canvas-wrap { flex-grow: 1; position: relative; overflow: hidden; }
        canvas { display: block; width: 100%; height: 100%; }

        /* Panel de Controles Fijo al fondo */
        #control-panel { height: 160px; background: #111; border-top: 4px solid #FFD700; display: flex; justify-content: space-around; align-items: center; padding: 0 10px; z-index: 100; }
        
        .btn { width: 80px; height: 80px; background: #333; border: 3px solid #FFD700; border-radius: 15px; display: flex; justify-content: center; align-items: center; font-size: 30px; color: white; -webkit-tap-highlight-color: transparent; }
        .btn:active { background: #555; transform: scale(0.95); }

        #ui { position: absolute; top: 40px; width: 100%; display: flex; justify-content: space-around; color: #00FF00; font-weight: bold; font-size: 20px; text-shadow: 2px 2px #000; pointer-events: none; }
        
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 200; text-align: center; }
        .btn-start { padding: 20px 40px; font-size: 22px; background: #FFD700; border: none; border-radius: 10px; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="ui">
        <div>LVL: <span id="lvl">1</span></div>
        <div>‚è∞: <span id="clocks">0</span>/10</div>
        <div>‚ù§Ô∏è: <span id="lives">3</span></div>
    </div>

    <div id="canvas-wrap">
        <canvas id="gameCanvas"></canvas>
        <div id="overlay">
            <h1 id="title">HOMER RUN</h1>
            <p id="msg">Atrapa 10 relojes</p>
            <button class="btn-start" onclick="startGame()">¬°EMPEZAR!</button>
        </div>
    </div>

    <div id="control-panel">
        <div class="btn" id="bL">‚¨ÖÔ∏è</div>
        <div class="btn" id="bC">üîò</div>
        <div class="btn" id="bR">‚û°Ô∏è</div>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const lvlEl = document.getElementById('lvl'), livesEl = document.getElementById('lives'), clocksEl = document.getElementById('clocks'), overlay = document.getElementById('overlay');

    let level = 1, score = 0, lives = 3, isPlaying = false, frame = 0;
    let player = { x: 0, y: 0, vx: 0, vy: 0, grav: 0.8, jumps: 0 };
    let items = [], obstacles = [];

    function resize() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function initLevel() {
        score = 0; clocksEl.innerText = "0/10"; lvlEl.innerText = level;
        items = []; obstacles = []; frame = 0;
        player.x = canvas.width / 2 - 30;
        player.y = canvas.height - 100;
        player.vx = 0; player.vy = 0;
    }

    function spawn() {
        if(items.length < 1) {
            items.push({
                x: 50 + Math.random()*(
